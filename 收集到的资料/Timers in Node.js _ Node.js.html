<!DOCTYPE html>
<!-- saved from url=(0049)https://nodejs.org/en/docs/guides/timers-in-node/ -->
<html lang="en" class=" has-js"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>Timers in Node.js | Node.js</title>

  <link rel="dns-prefetch" href="http://fonts.googleapis.com/">
  <link rel="dns-prefetch" href="http://fonts.gstatic.com/">
  <link rel="dns-prefetch" href="http://www.google-analytics.com/">

  <meta name="author" content="Node.js Foundation">
  <meta name="robots" content="index, follow">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="apple-touch-icon" href="https://nodejs.org/static/apple-touch-icon.png">
  <link rel="icon" sizes="32x32" type="image/png" href="https://nodejs.org/static/favicon.png">

  <link rel="canonical" href="https://nodejs.org/en/docs/guides/timers-in-node/">
  <link rel="alternate" href="https://nodejs.org/en/feed/blog.xml" title="Node.js Blog" type="application/rss+xml">
  <link rel="alternate" href="https://nodejs.org/en/feed/releases.xml" title="Node.js Blog: Releases" type="application/rss+xml">
  <link rel="alternate" href="https://nodejs.org/en/feed/vulnerability.xml" title="Node.js Blog: Vulnerability Reports" type="application/rss+xml">
  <link rel="alternate" href="https://nodejs.org/en/feed/tsc-minutes.xml" title="Node.js TSC meeting minutes" type="application/rss+xml">
  <link rel="stylesheet" href="./Timers in Node.js _ Node.js_files/styles.css" media="all">
  <link rel="stylesheet" href="./Timers in Node.js _ Node.js_files/css">
  <script async="" src="./Timers in Node.js _ Node.js_files/analytics.js.下载"></script><script>
  document.querySelector('html').className += " has-js";
    </script>
  </head>

<body>
  <header>
    <div class="container">
  
      <a href="https://nodejs.org/en" id="logo">
        <img src="./Timers in Node.js _ Node.js_files/logo.svg" alt="node.js">
      </a>
  
      <nav>
        <ul class="list-divider-pipe">
          <li>
            <a href="https://nodejs.org/en/">Home</a>
          </li>
  
            <li>
              <a href="https://nodejs.org/en/about/">About</a>
            </li>
            <li>
              <a href="https://nodejs.org/en/download/">Downloads</a>
            </li>
            <li class="active">
              <a href="https://nodejs.org/en/docs/">Docs</a>
            </li>
            <li>
              <a href="https://nodejs.org/en/foundation/">Foundation</a>
            </li>
            <li>
              <a href="https://nodejs.org/en/get-involved/">Get Involved</a>
            </li>
            <li>
              <a href="https://nodejs.org/en/security/">Security</a>
            </li>
            <li>
              <a href="https://nodejs.org/en/blog/">News</a>
            </li>
        </ul>
      </nav>
  
    </div>
  </header>

  <div id="main">
    <div class="container has-side-nav">

      <aside>
        <ul>
                <li>
                      <a href="https://nodejs.org/en/docs/">Docs</a>
                </li>
                <li>
                      <a href="https://nodejs.org/en/docs/es6/">ES6 and beyond</a>
                </li>
                <li>
                      <a href="https://nodejs.org/en/docs/faq/">FAQ</a>
                </li>
                <li>
                    <a href="https://nodejs.org/dist/latest-v6.x/docs/api">v6.9.5 API <span class="small color-lightgray">LTS</span></a>
                </li>
                <li>
                    <a href="https://nodejs.org/dist/latest-v7.x/docs/api">v7.5.0 API</a>
                </li>
                <li>
                      <a href="https://nodejs.org/en/docs/guides/">Guides</a>
                </li>
        </ul>
      </aside>

      <article>
        <h1 id="header-timers-in-node-js-and-beyond">Timers in Node.js and beyond<a name="timers-in-node-js-and-beyond" class="anchor" href="https://nodejs.org/en/docs/guides/timers-in-node/#timers-in-node-js-and-beyond" aria-labelledby="header-timers-in-node-js-and-beyond"></a></h1><p>The Timers module in Node.js contains functions that execute code after a set
period of time. Timers do not need to be imported via <code>require()</code>, since
all the methods are available globally to emulate the browser JavaScript API.
To fully understand when timer functions will be executed, it's a good idea to
read up on the the Node.js
<a href="https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/">Event Loop</a>.</p>
<h2 id="header-controlling-the-time-continuum-with-node-js">Controlling the Time Continuum with Node.js<a name="controlling-the-time-continuum-with-node-js" class="anchor" href="https://nodejs.org/en/docs/guides/timers-in-node/#controlling-the-time-continuum-with-node-js" aria-labelledby="header-controlling-the-time-continuum-with-node-js"></a></h2><p>The Node.js API provides several ways of scheduling code to execute at
some point after the present moment. The functions below may seem familiar,
since they are available in most browsers, but Node.js actually provides
its own implementation of these methods. Timers integrate very closely
with the system, and despite the fact that the API mirrors the browser
API, there are some differences in implementation.</p>
<h3 id="header-when-i-say-so-execution-settimeout">"When I say so" Execution ~ <em><code>setTimeout()</code></em><a name="when-i-say-so-execution-settimeout" class="anchor" href="https://nodejs.org/en/docs/guides/timers-in-node/#when-i-say-so-execution-settimeout" aria-labelledby="header-when-i-say-so-execution-settimeout"></a></h3><p><code>setTimeout()</code> can be used to schedule code execution after a designated
amount of milliseconds. This function is similar to
<a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setTimeout"><code>window.setTimeout()</code></a>
from the browser JavaScript API, however a string of code cannot be passed
to be executed.</p>
<p><code>setTimeout()</code> accepts a function to execute as its first argument and the
millisecond delay defined as a number as the second argument. Additional
arguments may also be included and these will be passed on to the function. Here
is an example of that:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> myFunc <span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'arg was =&gt; '</span> <span class="token operator">+</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span>myFunc<span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">,</span> <span class="token string">'funky'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The above function <code>myFunc()</code> will execute as close to 1500
milliseconds (or 1.5 seconds) as possible due to the call of <code>setTimeout()</code>.</p>
<p>The timeout interval that is set cannot be relied upon to execute after
that <em>exact</em> number of milliseconds. This is because other executing code that
blocks or holds onto the event loop will push the execution of the timeout
back. The <em>only</em> guarantee is that the timeout will not execute <em>sooner</em> than
the declared timeout interval.</p>
<p><code>setTimeout()</code> returns a <code>Timeout</code> object that can be used to reference the
timeout that was set. This returned object can be used to cancel the timeout (
see <code>clearTimeout()</code> below) as well as change the execution behavior (see
<code>unref()</code> below).</p>
<h3 id="header-right-after-this-execution-setimmediate">"Right after this" Execution ~ <em><code>setImmediate()</code></em><a name="right-after-this-execution-setimmediate" class="anchor" href="https://nodejs.org/en/docs/guides/timers-in-node/#right-after-this-execution-setimmediate" aria-labelledby="header-right-after-this-execution-setimmediate"></a></h3><p><code>setImmediate()</code> will execute code at the end of the current event loop cycle.
This code will execute <em>after</em> any I/O operations in the current event loop and
<em>before</em> any timers scheduled for the next event loop. This code execution
could be thought of as happening "right after this", meaning any code following
the <code>setImmediate()</code> function call will execute before the <code>setImmediate()</code>
function argument.</p>
<p>The first argument to <code>setImmediate()</code> will be the function to execute. Any
subsequent arguments will be passed to the function when it is executed.
Here's an example:</p>
<pre class="language-js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'before immediate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`executing immediate: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arg<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'so immediate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'after immediate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The above function passed to <code>setImmediate()</code> will execute after all runnable
code has executed, and the console output will be:</p>
<pre><code>before immediate
after immediate
executing immediate: so immediate
</code></pre><p><code>setImmediate()</code> returns and <code>Immediate</code> object, which can be used to cancel
the scheduled immediate (see <code>clearImmediate()</code> below).</p>
<p>Note: Don't get <code>setImmediate()</code> confused with <code>process.nextTick()</code>. There are
some major ways they differ. The first is that <code>process.nextTick()</code> will run
<em>before</em> any <code>Immediate</code>s that are set as well as before any scheduled I/O.
The second is that <code>process.nextTick()</code> is non-clearable, meaning once
code has been scheduled to execute with <code>process.nextTick()</code>, the execution
cannot be stopped, just like with a normal function. Refer to <a href="https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/#processnexttick">this guide</a>
to better understand the operation of <code>process.nextTick()</code>.</p>
<h3 id="header-infinite-loop-execution-setinterval">"Infinite Loop" Execution ~ <em><code>setInterval()</code></em><a name="infinite-loop-execution-setinterval" class="anchor" href="https://nodejs.org/en/docs/guides/timers-in-node/#infinite-loop-execution-setinterval" aria-labelledby="header-infinite-loop-execution-setinterval"></a></h3><p>If there is a block of code that should execute multiple times, <code>setInterval()</code>
can be used to execute that code. <code>setInterval()</code> takes a function
argument that will run an infinite number of times with a given millisecond
delay as the second argument. Just like <code>setTimeout()</code>, additional arguments
can be added beyond the delay, and these will be passed on to the function call.
Also like <code>setTimeout()</code>, the delay cannot be guaranteed because of operations
that may hold on to the event loop, and therefore should be treated as an
approximate delay. See the below example:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> intervalFunc <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Cant stop me now!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">setInterval</span><span class="token punctuation">(</span>intervalFunc<span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>In the above example, <code>intervalFunc()</code> will execute about every 1500
milliseconds, or 1.5 seconds, until it is stopped (see below).</p>
<p>Just like <code>setTimeout()</code>, <code>setInterval()</code> also returns a <code>Timeout</code> object which
can be used to reference and modify the interval that was set.</p>
<h2 id="header-clearing-the-future">Clearing the Future<a name="clearing-the-future" class="anchor" href="https://nodejs.org/en/docs/guides/timers-in-node/#clearing-the-future" aria-labelledby="header-clearing-the-future"></a></h2><p>What can be done if a <code>Timeout</code> or <code>Immediate</code> object needs to be cancelled?
<code>setTimeout()</code>, <code>setImmediate()</code>, and <code>setInterval()</code> return a timer object
that can be used to reference the set <code>Timeout</code> or <code>Immediate</code> object.
By passing said object into the respective <code>clear</code> function, execution of
that object will be halted completely. The respective functions are
<code>clearTimeout()</code>, <code>clearImmediate()</code>, and <code>clearInterval()</code>. See the example
below for an example of each:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">let</span> timeoutObj <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timeout beyond time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> immediateObj <span class="token operator">=</span> <span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'immediately executing immediate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> intervalObj <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'interviewing the interval'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">clearImmediate</span><span class="token punctuation">(</span>immediateObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="header-leaving-timeouts-behind">Leaving Timeouts Behind<a name="leaving-timeouts-behind" class="anchor" href="https://nodejs.org/en/docs/guides/timers-in-node/#leaving-timeouts-behind" aria-labelledby="header-leaving-timeouts-behind"></a></h2><p>Remember that <code>Timeout</code> objects are returned by <code>setTimeout</code> and <code>setInterval</code>.
The <code>Timeout</code> object provides two functions intended to augment <code>Timeout</code>
behavior with <code>unref()</code> and <code>ref()</code>. If there is a <code>Timeout</code> object scheduled
using a <code>set</code> function, <code>unref()</code> can be called on that object. This will change
the behavior slightly, and not call the <code>Timeout</code> object <em>if it is the last
code to execute</em>. The <code>Timeout</code> object will not keep the process alive, waiting
to execute.</p>
<p>In similar fashion, a <code>Timeout</code> object that has had <code>unref()</code> called on it
can remove that behavior by calling <code>ref()</code> on that same <code>Timeout</code> object,
which will then ensure its execution. Be aware, however, that this does
not <em>exactly</em> restore the initial behavior for performance reasons. See
below for examples of both:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">let</span> timerObj <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'will i run?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// if left alone, this statement will keep the above</span>
<span class="token comment" spellcheck="true">// timeout from running, since the timeout will be the only</span>
<span class="token comment" spellcheck="true">// thing keeping the program from exiting</span>
timerObj<span class="token punctuation">.</span><span class="token function">unref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// we can bring it back to life by calling ref() inside</span>
<span class="token comment" spellcheck="true">// an immediate</span>
<span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  timerObj<span class="token punctuation">.</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="header-further-down-the-event-loop">Further Down the Event Loop<a name="further-down-the-event-loop" class="anchor" href="https://nodejs.org/en/docs/guides/timers-in-node/#further-down-the-event-loop" aria-labelledby="header-further-down-the-event-loop"></a></h2><p>There's much more to the Event Loop and Timers than this guide
has covered. To learn more about the internals of the Node.js
Event Loop and how Timers operate during execution, check out
this Node.js guide: <a href="https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/">The Node.js Event Loop, Timers, and
process.nextTick()</a>.</p>

      </article>

    </div>
  </div>

  <a href="https://nodejs.org/en/docs/guides/timers-in-node/#" id="scroll-to-top" style="display: none;">↑ <span>Scroll to top</span></a>
  
  <footer role="contentinfo">
  
    <div class="container">
      <div class="linuxfoundation-footer">
        <div class="issue-link-container">
          <a class="linuxfoundation-logo" href="http://collabprojects.linuxfoundation.org/">
            <img alt="Linux Foundation Collaborative Projects" src="./Timers in Node.js _ Node.js_files/lfcp.png">
          </a>
          <ul class="list-divider-pipe issue-link">
            <li><a href="https://github.com/nodejs/node/issues">Report Node.js issue</a></li>
            <li><a href="https://github.com/nodejs/nodejs.org/issues">Report website issue</a></li>
            <li><a href="https://github.com/nodejs/help/issues">Get Help</a></li>
          </ul>
        </div>
  
        <p>© 2017 Node.js Foundation. All Rights Reserved. Portions of this site originally © 2017 Joyent. </p>
        <p>Node.js is a trademark of Joyent, Inc. and is used with its permission. Please review the <a href="https://nodejs.org/static/documents/trademark-policy.pdf">Trademark Guidelines of the Node.js Foundation</a>.</p>
        <p>Linux Foundation is a registered trademark of The Linux Foundation.</p>
        <p>Linux is a registered <a href="http://www.linuxfoundation.org/programs/legal/trademark" title="Linux Mark Institute">trademark</a> of Linus Torvalds.</p>
        <p>
          <a href="https://raw.githubusercontent.com/nodejs/node/master/LICENSE">Node.js Project Licensing Information</a>.
        </p>
      </div>
    </div>
  
  </footer>
  
  <link rel="stylesheet" href="./Timers in Node.js _ Node.js_files/prism-tomorrow.css" media="all">
  <script type="text/javascript">
    var $scrollToTop = document.getElementById('scroll-to-top');
    (window.onscroll = function() {
      $scrollToTop.style.display = (window.pageYOffset > window.innerHeight) ? 'block' : 'none';
    })();
    $scrollToTop.onclick = function() {
      window.scrollTo(0, 0);
      return false;
    };
  </script>
  
  <script>
    (function(d,e,m,s){
      if (!/(MSIE|Trident)/.test(navigator.userAgent)){return;}
      m=d.createElement(e);
      s=d.getElementsByTagName(e)[0];m.async=1;m.src='/static/js/modernizr.custom.js';
      m.onload=function(){Modernizr.addTest('flexboxtweener', Modernizr.testAllProps('flexAlign'));};
      s.parentNode.insertBefore(m,s);
    })(document,'script');
  </script>
  
  <script src="./Timers in Node.js _ Node.js_files/dnt_helper.js.下载"></script>
  <script>
    if (!_dntEnabled()) {
      !function(n,o,d,e,j,s){n.GoogleAnalyticsObject=d;n[d]||(n[d]=function(){
      (n[d].q=n[d].q||[]).push(arguments)});n[d].l=+new Date;j=o.createElement(e);
      s=o.getElementsByTagName(e)[0];j.async=1;j.src='//www.google-analytics.com/analytics.js';
      s.parentNode.insertBefore(j,s)}(window,document,'ga','script');
  
      ga('create', 'UA-67020396-1', 'auto');
      ga('send', 'pageview');
    }
  </script>


</body></html>